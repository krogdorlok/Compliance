# Compliance Chatbot MVP

This project is a Minimum Viable Product (MVP) of a compliance chatbot for the financial domain. It's built with Python, FastAPI, scikit-learn, spaCy, and SQLModel.

## Project Structure

```
compliance_chatbot/
│
├── app/
│   ├── main.py
│   ├── models.py
│   ├── ml/
│   │   ├── intent_model.py
│   │   └── entity_extractor.py
│   ├── db/
│   │   ├── database.py
│   │   └── crud.py
│   ├── anonymizer.py
│   └── utils.py
│
├── data/
│   ├── intents.csv
│   ├── ner_examples.csv
│   ├── intent_model.pkl
│   └── ner_model/
│
├── tests/
│   ├── test_anonymizer.py
│   └── test_crud.py
│
├── generate_data.py
├── requirements.txt
└── README.md
```

## Installation

1.  **Clone the repository:**

    ```bash
    git clone <repository-url>
    cd compliance-chatbot
    ```

2.  **Create and activate a virtual environment:**

    ```bash
    python3 -m venv .venv
    source .venv/bin/activate
    ```

3.  **Install the dependencies:**
    ```bash
    pip install -r requirements.txt
    ```

## Usage

1.  **Generate sample data (optional):**
    If you want to generate new sample data, run the following command:

    ```bash
    python3 generate_data.py
    ```

2.  **Train the models:**
    To train the intent classification and NER models, run the following commands:

    ```bash
    python3 -m app.ml.intent_model
    python3 -m app.ml.entity_extractor
    ```

3.  **Run the FastAPI server:**
    ```bash
    uvicorn app.main:app --reload
    ```
    The application will be available at `http://127.0.0.1:8000`.

## API Documentation

The API documentation is automatically generated by FastAPI and is available at `http://127.0.0.1:8000/docs`.

### Endpoints

- `GET /health`: Health check endpoint.
- `POST /predict_intent`: Predicts the intent of a user's query.
- `POST /extract_entities`: Extracts entities from a user's query.
- `POST /chat`: Handles a user's chat query, including intent classification, entity extraction, anonymization, and logging.

## Running the Tests

To run the tests, execute the following command from the root of the project:

```bash
python3 -m unittest discover -s tests
```

## Extending the Project

This project is designed to be extensible. Here are some ways you can extend it:

- **Add more training data:** You can add more examples to `data/intents.csv` and `data/ner_examples.csv` to improve the models' accuracy.
- **Use more advanced models:** The current models are simple and can be replaced with more sophisticated ones (e.g., using deep learning).
- **Improve the anonymizer:** The anonymizer can be improved to detect and mask a wider range of PII.
- **Add a user interface:** You can build a frontend application (e.g., using Streamlit or a JavaScript framework) to interact with the chatbot.
